{"version":3,"sources":["datafile.js"],"names":[],"mappings":"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","file":"datafile-compiled.js","sourcesContent":["var Datafile = Vue.extend({\n  template: '#datafile',\n\n  data: function () {\n    return {\n      sugs: {},\n    }\n  },\n\n  created: function () {\n\n  },\n  mounted: function () {\n    this.init(this.$route.params.id)\n    vpage.updateStyle($(\"li[name='page']\")[0])\n  },\n  watch: { //默认Vue只在第一次加载初始化，watch用于检测Vue实例的数据是否发生了变化，变化后触发事件\n    '$route'(to, from){\n      db = to.path.split(\"/\")[to.path.split(\"/\").length - 1]\n      this.init(db)\n    }\n  },\n  methods: {\n    init: function (db) {\n      var _self = this\n      $(\"#floatLayer\").show()\n      $(\"#liadloging\").show()\n\n      $.ajax({\n        type: \"post\",\n        url: \"/get_data/\",\n        data: {db: db},\n        async: false,\n        success: function (data) {\n          //if (timeout) { //清除定时器\n          //  clearTimeout(timeout);\n          //  timeout = null;\n          //}\n\n          _self.sugs = data[\"sugs\"]\n\n          $(\"#floatLayer\").hide()\n          $(\"#liadloging\").hide()\n        }\n      })\n    },\n    addData: function () {\n      data = this.getSelectedData()\n      if (data[\"sug\"]) {\n        this.modify(\"/add_segs_sugs/\", data)\n      }\n      toastr.success(\"保存成功\");\n    },\n    deleteData: function () {\n      data = this.getSelectedData()\n      if (data[\"sug\"]) {\n        if (!window.confirm(\"确认删除?\"))\n          return false\n        this.modify(\"/delete_segs_sugs/\", data)\n      }\n      toastr.success(\"删除成功\");\n    },\n    getSelectedData: function () {\n      data = {}\n      data[\"sug\"] = this.get_seleted_items($(\"#table2 tbody .warning td\"))  //item1-中心词,item2-部位...\n      return data\n    },\n    modify: function (url, data) {\n      var _self = this\n      $.post(url, {msg: JSON.stringify(data)}, function (data) {\n        if (data.hasOwnProperty(\"sugs\")) {\n          _self.sugs = data[\"sugs\"]\n        } else if (data.hasOwnProperty(\"items\")) {\n          _self.sugs = data[\"items\"]\n        }\n\n        clear_checkbox($('#table2 thead tr'), $('#table2 tbody tr'))\n      })\n    },\n    get_seleted_items: function (items) {\n      contents = \"\"\n      $.each(items, function (i, item) {\n        if (i % 4 === 1) {\n          contents += item.innerText + \",\"\n        }\n      })\n      return contents\n    },\n    downloadSug: function () {\n      url = \"/download_sug/\"\n      var _self = this;\n      $.post(url, function (data) {\n        if (data)\n          _self.funDownload(data, \"sug.csv\")\n      })\n    }\n    ,\n    // 下载文件\n    funDownload: function (content, filename) {\n      var eleLink = document.createElement('a');\n      eleLink.download = filename;\n      eleLink.style.display = 'none';\n      // 字符内容转变成blob地址\n      var blob = new Blob([content]);\n      eleLink.href = URL.createObjectURL(blob);\n      // 触发点击\n      document.body.appendChild(eleLink);\n      eleLink.click();\n      // 然后移除\n      document.body.removeChild(eleLink);\n\n    }\n    ,\n    initTableCheckbox: function () {\n      this.initBox($('#table2 thead tr'), $('#table2 tbody tr'))\n    }\n    ,\n    initBox: function ($thr, $tbr) {\n      var $checkAllTh = $('<th><input type=\"checkbox\" id=\"checkAll\" name=\"checkAll\" /></th>');\n      //console.log($checkAllTh)\n      //console.log($thr)\n      /*将全选/反选复选框添加到表头最前，即增加一列*/\n      $thr.prepend($checkAllTh);\n\n      /*“全选/反选”复选框*/\n      var $checkAll = $thr.find('input');\n      $checkAll.click(function (event) {\n        console.log(\"click\")\n        /*将所有行的选中状态设成全选框的选中状态*/\n        $tbr.find('input').prop('checked', $(this).prop('checked'));\n        /*并调整所有选中行的CSS样式*/\n        if ($(this).prop('checked')) {\n          $tbr.find('input').parent().parent().addClass('warning');\n        } else {\n          $tbr.find('input').parent().parent().removeClass('warning');\n        }\n        /*阻止向上冒泡，以防再次触发点击操作*/\n        event.stopPropagation();\n      });\n      /*点击全选框所在单元格时也触发全选框的点击操作*/\n      $checkAllTh.click(function () {\n        console.log(\"click1\")\n        $(this).find('input').click();\n      });\n\n      var $checkItemTd = $('<td><input type=\"checkbox\" name=\"checkItem\" /></td>');\n      /*每一行都在最前面插入一个选中复选框的单元格*/\n      console.log($('table tbody tr'))\n      $tbr.prepend($checkItemTd);\n      console.log($tbr)\n      /*点击每一行的选中复选框时*/\n      $tbr.find('input').click(function (event) {\n        //console.log(\"click3\")\n        /*调整选中行的CSS样式*/\n        $(this).parent().parent().toggleClass('warning');\n        /*如果已经被选中行的行数等于表格的数据行数，将全选框设为选中状态，否则设为未选中状态*/\n        $checkAll.prop('checked', $tbr.find('input:checked').length == $tbr.length ? true : false);\n        /*阻止向上冒泡，以防再次触发点击操作*/\n        event.stopPropagation();\n      });\n      /*点击每一行时也触发该行的选中操作*/\n      $tbr.click(function () {\n        //console.log(\"click2\")\n        $(this).find('input').click();\n      });\n    }\n  }\n})\n\nfunction clear_checkbox($thr, $tbr) {\n  $tbr.find('input').prop('checked', false)\n  $tbr.find('input').parent().parent().removeClass('warning')\n  $thr.find('input').prop('checked', false)\n}\n"]}