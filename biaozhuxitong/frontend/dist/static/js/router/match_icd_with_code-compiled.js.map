{"version":3,"sources":["match_icd_with_code.js"],"names":[],"mappings":"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","file":"match_icd_with_code-compiled.js","sourcesContent":["var MatchICDCode = Vue.extend({\n  template: '#match_with_code',\n  props: ['id'],\n\n  data: function () {\n    return {\n      icds: \"\",\n      source_list: {},\n      ischeck: {}, //用于checkbox的v-model，是否选中\n      match_result:\"\", //是否有返回值\n    }\n  },\n  beforeMount: function () {\n    this.init(this.$route.params.id)\n  },\n  watch: { //默认Vue只在第一次加载初始化，watch用于检测Vue实例的数据是否发生了变化，变化后触发事件\n    '$route'(to, from){\n      //跳转的路径（to）\n      db = to.path.split(\"/\")[to.path.split(\"/\").length - 1]\n      this.init(db)\n    }\n  },\n  components: {\n    pg: Page,\n  },\n  methods: {\n    init: function (db) {\n      $(\"#icdname\").val(\"\")\n      $(\"#code\").val(\"\")\n      var _self = this\n      $.ajax({\n        type: \"post\",\n        url: \"/load_source/\",\n        data: {db: db},\n        success: function (data) {\n          _self.source_list = data[\"source\"]\n          _self.ischeck = data[\"ischeck\"]\n        }\n      })\n    },\n    match: function () {\n      icd=\"\"\n      code = $(this.$refs.code).val().trim()\n\n      source_list = []\n      for (k in this.ischeck) {\n        if (this.ischeck[k]) {\n          source_list.push(k)\n        }\n      }\n      if (vutils.jsonLength(source_list)>0) {\n        if (this.check_icd(code, this.$route.params.id)) {\n          var _self = this\n          $.ajax({\n            type: \"post\",\n            url: \"/match_icd_with_code/\",\n            data: {icd: icd, code: code, source_list: JSON.stringify(source_list), db: _self.$route.params.id},\n            success: function (data) {\n              if (icd != \"\")\n                _self.icds = data[icd] //list:[icd,code,ratio,match_index]*n\n              else\n                _self.icds = data\n\n              if (vutils.isEmptyObject(data)){\n                _self.match_result=\"暂无结果\"\n              }\n              else\n                _self.match_result=\"\"\n            }\n          })\n        } else {\n          document.getElementById('code').focus()\n           this.match_result=\"暂无结果\"\n          this.icds=\"\"\n          toastr.error(\"编码格式错误\");\n        }\n      } else {\n        this.match_result=\"暂无结果\"\n        this.icds=\"\"\n        toastr.error(\"请选择术语集来源\");\n      }\n    },\n    get_source: function (arr) {\n      if (arr.length == 3)\n        return arr[2]\n      else\n        return arr[3]\n    },\n    has_element: function (arr, b) {\n      return vutils.has_element(arr[arr.length - 1], b)\n    },\n    get_index: function (index) {\n      return index + 1\n    },\n    check_icd: function (code, type) {\n      if (type == \"zhenduan\") {\n        return this.check_icd_zhenduan(code)\n      } else if (type == \"shoushu\") {\n        return this.check_icd_shoushu(code)\n      }\n    },\n    check_icd_zhenduan: function (code) {\n      var reg = /^[A-Za-z][0-9][0-9]$/;\n      if (code.length > 2 && code.length < 10) {\n        if (reg.test(code.substring(0, 3))) {\n          return true\n        }\n      }\n      return false\n    },\n    check_icd_shoushu: function (code) {\n      // var reg = /^[0-9][0-9]$/;\n      // if (code.length > 1 && code.length < 10) {\n      //   if (reg.test(code.substring(0, 2))) {\n      //     return true\n      //   }\n      // }\n      // return false\n      code = code.replace(\"x\", \"\") //有的手术带有x\n      code = code.replace(\" \", \"\") //\n      var regPos = /^\\d+(\\.\\d+)?$/; //浮点数\n      if (regPos.test(code)) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n  }\n})\n"]}