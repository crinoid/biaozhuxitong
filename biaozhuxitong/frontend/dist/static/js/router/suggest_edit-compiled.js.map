{"version":3,"sources":["suggest_edit.js"],"names":[],"mappings":";AAAA,IAAI,cAAc,IAAI,MAAJ,CAAW;AAC3B,YAAU,cADiB;;AAG3B,QAAM,gBAAY;AAChB,WAAO;AACL,gBAAU,EADL,EACS;AACd,cAAQ,EAFH,EAEO;AACZ,gBAAU,EAHL,EAGS;AACd,oBAAc,EAJT,CAIa;AAJb,KAAP;AAMD,GAV0B;;AAY3B,WAAS,mBAAY;AACnB,SAAK,IAAL,CAAU,KAAK,MAAL,CAAY,MAAZ,CAAmB,EAA7B;AACD,GAd0B;AAe3B,SAAO;AAAE;AACP,YADK,kBACI,EADJ,EACQ,IADR,EACa;AAChB;AACA,WAAK,GAAG,IAAH,CAAQ,KAAR,CAAc,GAAd,EAAmB,GAAG,IAAH,CAAQ,KAAR,CAAc,GAAd,EAAmB,MAAnB,GAA4B,CAA/C,CAAL;AACA,WAAK,IAAL,CAAU,EAAV;AACD;AALI,GAfoB;AAsB3B,WAAS;AACP,UAAM,cAAU,EAAV,EAAc;AAClB,UAAI,MAAM,oBAAV;AACA,UAAI,QAAQ,IAAZ;;AAEA,UAAI,UAAU,WAAW,YAAY;AACjC,cAAM,MAAN;AACD,OAFW,EAGZ,IAHY,CAGP;AAHO,OAAd;AAKA;AACA,QAAE,IAAF,CAAO;AACL,cAAM,MADD;AAEL,aAAK,GAFA;AAGL,cAAM,EAAC,IAAI,EAAL,EAHD;AAIL,eAAO,KAJF;AAKL,iBAAS,iBAAU,IAAV,EAAgB;AACvB,cAAI,OAAJ,EAAa;AAAE;AACb,yBAAa,OAAb;AACA,sBAAU,IAAV;AACD;AACD,YAAE,aAAF,EAAiB,IAAjB;AACA,YAAE,aAAF,EAAiB,IAAjB;;AAEA,gBAAM,QAAN,GAAiB,KAAK,UAAL,CAAjB;AACA,gBAAM,MAAN,GAAe,KAAK,QAAL,CAAf;AACD;AAfI,OAAP;AAiBD,KA5BM;AA6BP,kBAAc,wBAAY;AACxB,gBAAU,EAAE,MAAF,EAAU,GAAV,GAAgB,IAAhB,EAAV;AACA,UAAI,OAAO,WAAP,CAAmB,KAAK,QAAxB,EAAkC,OAAlC,CAAJ,EAAgD;AAC9C,eAAO,OAAP,CAAe,UAAf;AACD,OAFD,MAGK,IAAI,KAAK,QAAL,CAAc,MAAd,GAAqB,EAAzB,EAA4B;AAC/B,eAAO,OAAP,CAAe,UAAf;AACD,OAFI,MAGA,IAAI,WAAW,EAAf,EAAmB;AACtB,UAAE,aAAF,EAAiB,IAAjB;AACA,UAAE,aAAF,EAAiB,IAAjB;AACA,YAAI,QAAQ,IAAZ;AACA,cAAM,gBAAN;AACA,UAAE,IAAF,CAAO;AACL,gBAAM,MADD;AAEL,eAAK,GAFA;AAGL,gBAAM,EAAC,QAAQ,OAAT,EAHD;AAIL,iBAAO,KAJF;AAKL,mBAAS,iBAAU,IAAV,EAAgB;AACvB,cAAE,aAAF,EAAiB,IAAjB;AACA,cAAE,aAAF,EAAiB,IAAjB;AACA,mBAAO,OAAP,CAAe,MAAf;AACA,kBAAM,IAAN,CAAW,MAAM,MAAN,CAAa,MAAb,CAAoB,EAA/B;AACD;AACD;AACA;AACA;AAbK,SAAP;AAeD;AACF,KA1DM;AA2DP,mBAAe,uBAAU,EAAV,EAAc;AAC3B,QAAE,MAAM,EAAR,EAAY,WAAZ,CAAwB,eAAxB;AACA,QAAE,MAAM,EAAR,EAAY,IAAZ,CAAiB,UAAjB,EAA6B,KAA7B;AACA,QAAE,MAAM,EAAR,EAAY,KAAZ;AAED,KAhEM;AAiEP,qBAAiB,yBAAU,EAAV,EAAc;AAC7B,UAAI,CAAC,OAAO,OAAP,CAAe,OAAf,CAAL,EACE,OAAO,KAAP;AACF,eAAS,EAAE,MAAM,EAAR,EAAY,GAAZ,EAAT;AACA,UAAI,QAAQ,IAAZ;AACA,QAAE,IAAF,CAAO;AACL,cAAM,MADD;AAEL,aAAK,uBAFA;AAGL,cAAM,EAAC,UAAU,MAAX,EAHD;AAIL,iBAAS,iBAAU,IAAV,EAAgB;AACvB,gBAAM,IAAN,CAAW,MAAM,MAAN,CAAa,MAAb,CAAoB,EAA/B;AACA,iBAAO,OAAP,CAAe,MAAf;AACD,SAPI;AAQL,eAAO,eAAU,cAAV,EAA0B,UAA1B,EAAsC,WAAtC,EAAmD;AACxD,kBAAQ,GAAR,CAAY,UAAZ;AACD;AAVI,OAAP;AAYD,KAlFM;AAmFP;AACA,mBAAe,yBAAY;AACzB,oBAAc,EAAd;AACA,WAAK,CAAL,IAAU,KAAK,QAAf,EAAyB;AACvB,oBAAY,IAAZ,CAAiB,EAAE,MAAM,KAAK,QAAL,CAAc,CAAd,CAAR,EAA0B,GAA1B,GAAgC,IAAhC,EAAjB;AACD;AACD,aAAO,WAAP;AACD,KA1FM;;AA4FP,qBAAiB,yBAAU,EAAV,EAAc,KAAd,EAAqB;AACpC,QAAE,MAAM,EAAR,EAAY,QAAZ,CAAqB,eAArB;AACA,QAAE,MAAM,EAAR,EAAY,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;;AAEA,UAAI,EAAE,MAAM,EAAR,EAAY,GAAZ,GAAkB,IAAlB,MAA4B,EAAhC,EAAoC;AAClC,UAAE,MAAM,EAAR,EAAY,GAAZ,CAAgB,KAAK,QAAL,CAAc,KAAd,CAAhB;AACD,OAFD,MAGK,IAAI,EAAE,MAAM,EAAR,EAAY,GAAZ,GAAkB,IAAlB,MAA4B,KAAK,QAAL,CAAc,KAAd,CAAhC,EAAsD;AACzD,cAAM,uBAAN;AACA,sBAAc,KAAK,aAAL,EAAd;AACA,YAAI,QAAQ,IAAZ;AACA,UAAE,IAAF,CAAO;AACL,gBAAM,MADD;AAEL,eAAK,GAFA;AAGL,gBAAM,EAAC,YAAY,gBAAe,KAAK,QAApB,CAAb,EAA4C,SAAS,gBAAe,WAAf,CAArD,EAHD;AAIL,mBAAS,iBAAU,IAAV,EAAgB;AACvB,kBAAM,IAAN,CAAW,MAAM,MAAN,CAAa,MAAb,CAAoB,EAA/B;AACA,mBAAO,OAAP,CAAe,MAAf;AACD;AAPI,SAAP;AASD;AACF,KAjHM;AAkHP,kBAAc,wBAAY;AACxB,aAAO,OAAO,YAAP,EAAP;AACD;AApHM;AAtBkB,CAAX,CAAlB","file":"suggest_edit-compiled.js","sourcesContent":["var SuggestEdit = Vue.extend({\n  template: '#suggestedit',\n\n  data: function () {\n    return {\n      suggests: [], //标注\n      counts: [], //每个标注多少术语\n      new_adds: [], //新添加的,删除这类词不需要进入后台\n      updated_ctgs: {}, //修改的标注\n    }\n  },\n\n  created: function () {\n    this.init(this.$route.params.id)\n  },\n  watch: { //默认Vue只在第一次加载初始化，watch用于检测Vue实例的数据是否发生了变化，变化后触发事件\n    '$route'(to, from){\n      //跳转的路径（to）\n      db = to.path.split(\"/\")[to.path.split(\"/\").length - 1]\n      this.init(db)\n    }\n  },\n  methods: {\n    init: function (db) {\n      var url = \"/get_all_suggests/\";\n      var _self = this;\n\n      var timeout = setTimeout(function () {\n          alert(\"连接超时\")\n        },\n        5000 //超时时间\n      );\n      //jquery版写法,还有vue-resource版\n      $.ajax({\n        type: \"post\",\n        url: url,\n        data: {db: db},\n        async: false,\n        success: function (data) {\n          if (timeout) { //清除定时器\n            clearTimeout(timeout);\n            timeout = null;\n          }\n          $(\"#floatLayer\").hide()\n          $(\"#liadloging\").hide()\n\n          _self.suggests = data['category']\n          _self.counts = data['counts']\n        }\n      })\n    },\n    add_category: function () {\n      new_ctg = $(\"#ctg\").val().trim()\n      if (vutils.has_element(this.suggests, new_ctg)) {\n        toastr.warning(\"请勿添加重复标注\");\n      }\n      else if (this.suggests.length>11){\n        toastr.warning(\"达到最大标注数量\");\n      }\n      else if (new_ctg != \"\") {\n        $(\"#floatLayer\").show()\n        $(\"#liadloging\").show()\n        var _self = this\n        url = '/add_category/'\n        $.ajax({\n          type: \"post\",\n          url: url,\n          data: {newctg: new_ctg},\n          async: false,\n          success: function (data) {\n            $(\"#floatLayer\").hide()\n            $(\"#liadloging\").hide()\n            toastr.success(\"添加成功\");\n            _self.init(_self.$route.params.id)\n          },\n          // error: function (XMLHttpRequest, textStatus, errorThrown) {\n          //   console.log(textStatus);\n          // }\n        })\n      }\n    },\n    edit_category: function (id) {\n      $(\"#\" + id).removeClass(\"input-display\")\n      $(\"#\" + id).attr(\"disabled\", false)\n      $(\"#\" + id).focus()\n\n    },\n    delete_category: function (id) {\n      if (!window.confirm(\"确认删除?\"))\n        return false\n      target = $(\"#\" + id).val()\n      var _self = this\n      $.ajax({\n        type: \"post\",\n        url: '/delete_sug_category/',\n        data: {category: target},\n        success: function (data) {\n          _self.init(_self.$route.params.id)\n          toastr.success(\"删除成功\");\n        },\n        error: function (XMLHttpRequest, textStatus, errorThrown) {\n          console.log(textStatus);\n        }\n      })\n    },\n    // 找出新修改的标注\n    update_option: function () {\n      updated_ctg = []\n      for (i in this.suggests) {\n        updated_ctg.push($(\"#\" + this.suggests[i]).val().trim())\n      }\n      return updated_ctg\n    },\n\n    update_category: function (id, index) {\n      $(\"#\" + id).addClass(\"input-display\")\n      $(\"#\" + id).attr(\"disabled\", true)\n\n      if ($(\"#\" + id).val().trim() == \"\") {\n        $(\"#\" + id).val(this.suggests[index])\n      }\n      else if ($(\"#\" + id).val().trim() != this.suggests[index]) {\n        url = '/update_sug_category/'\n        updated_ctg = this.update_option()\n        var _self = this\n        $.ajax({\n          type: \"post\",\n          url: url,\n          data: {origin_ctg: JSON.stringify(this.suggests), new_ctg: JSON.stringify(updated_ctg)},\n          success: function (data) {\n            _self.init(_self.$route.params.id)\n            toastr.success(\"保存成功\");\n          }\n        })\n      }\n    },\n    randomString: function () {\n      return vutils.randomString()\n    }\n  }\n})\n"]}